openapi: 3.0.0
info:
  title: CAPIF_Auditing_API
  description: >-
    This API enables the API management function to communicate with the CAPIF
    core function to retrieve the log information related to service API
    invocations.
  version: 1.0.0
externalDocs:
  description: 3GPP TS 29.222 V15.2.0 Common API Framework for 3GPP Northbound APIs
  url: 'http://www.3gpp.org/ftp/Specs/archive/29_series/29.222/'
servers:
  - url: '{apiRoot}/logs/v1'
    variables:
      apiRoot:
        default: 'https://example.com'
        description: apiRoot as defined in subclause 7.5 of 3GPP TS 29.222.
paths:
  /apiInvocationLogs:
    get:
      description: >-
        Query and retrieve service API invocation logs stored on the CAPIF core
        function.
      parameters:
        - name: aef-id
          in: query
          description: String identifying the API exposing function.
          schema:
            type: string
        - name: api-invoker-id
          in: query
          description: String identifying the API invoker which invoked the service API.
          schema:
            type: string
        - name: time-range-start
          in: query
          description: Start time of the invocation time range.
          schema:
            type: string
            description: string with format "date-time" as defined in OpenAPI.
        - name: time-range-end
          in: query
          description: End time of the invocation time range.
          schema:
            type: string
            description: string with format "date-time" as defined in OpenAPI.
        - name: api-id
          in: query
          description: String identifying the API invoked.
          schema:
            type: string
        - name: api-name
          in: query
          description: >-
            API name, it is set as {apiName} part of the URI structure as
            defined in subclause 4.4 of 3GPP TS 29.501.
          schema:
            type: string
        - name: api-version
          in: query
          description: Version of the API which was invoked.
          schema:
            type: string
        - name: protocol
          in: query
          description: Protocol invoked.
          schema:
            anyOf:
              - type: string
                enum:
                  - HTTP_1_1
                  - HTTP_2
              - type: string
                description: >
                  This string provides forward-compatibility with future
                  extensions to the enumeration but is not used to encode
                  content defined in the present version of this API.
            description: >
              Possible values are - HTTP_1_1: HTTP version 1.1 - HTTP_2: HTTP
              version 2
        - name: operation
          in: query
          description: Operation that was invoked on the API.
          schema:
            anyOf:
              - type: string
                enum:
                  - GET
                  - POST
                  - PUT
                  - PATCH
                  - DELETE
              - type: string
                description: >
                  This string provides forward-compatibility with future
                  extensions to the enumeration but is not used to encode
                  content defined in the present version of this API.
            description: >
              Possible values are - GET: HTTP GET method - POST: HTTP POST
              method - PUT: HTTP PUT method - PATCH: HTTP PATCH method - DELETE:
              HTTP DELETE method
        - name: result
          in: query
          description: Result or output of the invocation.
          schema:
            type: string
        - name: resource-name
          in: query
          description: Name of the specific resource invoked.
          schema:
            type: string
        - name: src-interface
          in: query
          description: Interface description of the API invoker.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ipv4Addr:
                    type: string
                    description: >-
                      string identifying a Ipv4 address formatted in the "dotted
                      decimal" notation as defined in IETF RFC 1166.
                  ipv6Addr:
                    type: string
                    description: >-
                      string identifying a Ipv6 address formatted according to
                      clause 4 in IETF RFC 5952. The mixed Ipv4 Ipv6 notation
                      according to clause 5 of IETF RFC 5952 shall not be used.
                  port:
                    type: integer
                    description: Unsigned integer with valid values between 0 and 65535.
                    minimum: 0
                    maximum: 65535
                  securityMethods:
                    type: array
                    items:
                      anyOf:
                        - type: string
                          enum:
                            - PSK
                            - PKI
                            - OAUTH
                        - type: string
                          description: >
                            This string provides forward-compatibility with
                            future extensions to the enumeration but is not used
                            to encode content defined in the present version of
                            this API.
                      description: >
                        Possible values are - PSK: Security method 1 (Using
                        TLS-PSK) as described in 3GPP TS 33.122 - PKI: Security
                        method 2 (Using PKI) as described in 3GPP TS 33.122 -
                        OAUTH: Security method 3 (TLS with OAuth token) as
                        described in 3GPP TS 33.122
                    minItems: 1
                    description: >-
                      Security methods supported by the interface, it take
                      precedence over the security methods provided in
                      AefProfile, for this specific interface.
                oneOf:
                  - required:
                      - ipv4Addr
                  - required:
                      - ipv6Addr
        - name: dest-interface
          in: query
          description: Interface description of the API invoked.
          content:
            application/json:
              schema:
                type: object
                properties:
                  ipv4Addr:
                    type: string
                    description: >-
                      string identifying a Ipv4 address formatted in the "dotted
                      decimal" notation as defined in IETF RFC 1166.
                  ipv6Addr:
                    type: string
                    description: >-
                      string identifying a Ipv6 address formatted according to
                      clause 4 in IETF RFC 5952. The mixed Ipv4 Ipv6 notation
                      according to clause 5 of IETF RFC 5952 shall not be used.
                  port:
                    type: integer
                    description: Unsigned integer with valid values between 0 and 65535.
                    minimum: 0
                    maximum: 65535
                  securityMethods:
                    type: array
                    items:
                      anyOf:
                        - type: string
                          enum:
                            - PSK
                            - PKI
                            - OAUTH
                        - type: string
                          description: >
                            This string provides forward-compatibility with
                            future extensions to the enumeration but is not used
                            to encode content defined in the present version of
                            this API.
                      description: >
                        Possible values are - PSK: Security method 1 (Using
                        TLS-PSK) as described in 3GPP TS 33.122 - PKI: Security
                        method 2 (Using PKI) as described in 3GPP TS 33.122 -
                        OAUTH: Security method 3 (TLS with OAuth token) as
                        described in 3GPP TS 33.122
                    minItems: 1
                    description: >-
                      Security methods supported by the interface, it take
                      precedence over the security methods provided in
                      AefProfile, for this specific interface.
                oneOf:
                  - required:
                      - ipv4Addr
                  - required:
                      - ipv6Addr
        - name: supported-features
          in: query
          description: To filter irrelevant responses related to unsupported features
          schema:
            type: string
            pattern: '^[A-Fa-f0-9]*$'
      responses:
        '200':
          description: >-
            Result of the query operation along with fetched service API
            invocation log data.
          content:
            application/json:
              schema:
                type: object
                properties:
                  aefId:
                    type: string
                    description: >-
                      Identity information of the API exposing function
                      requesting logging of service API invocations
                  apiInvokerId:
                    type: string
                    description: Identity of the API invoker which invoked the service API
                  logs:
                    type: array
                    items:
                      type: object
                      properties:
                        apiId:
                          type: string
                          description: String identifying the API invoked.
                        apiName:
                          type: string
                          description: >-
                            Name of the API which was invoked, it is set as
                            {apiName} part of the URI structure as defined in
                            subclause 4.4 of 3GPP TS 29.501.
                        apiVersion:
                          type: string
                          description: Version of the API which was invoked
                        resourceName:
                          type: string
                          description: Name of the specific resource invoked
                        uri:
                          type: string
                          description: >-
                            string providing an URI formatted according to IETF
                            RFC 3986.
                        protocol:
                          anyOf:
                            - type: string
                              enum:
                                - HTTP_1_1
                                - HTTP_2
                            - type: string
                              description: >
                                This string provides forward-compatibility with
                                future extensions to the enumeration but is not
                                used to encode content defined in the present
                                version of this API.
                          description: >
                            Possible values are - HTTP_1_1: HTTP version 1.1 -
                            HTTP_2: HTTP version 2
                        operation:
                          anyOf:
                            - type: string
                              enum:
                                - GET
                                - POST
                                - PUT
                                - PATCH
                                - DELETE
                            - type: string
                              description: >
                                This string provides forward-compatibility with
                                future extensions to the enumeration but is not
                                used to encode content defined in the present
                                version of this API.
                          description: >
                            Possible values are - GET: HTTP GET method - POST:
                            HTTP POST method - PUT: HTTP PUT method - PATCH:
                            HTTP PATCH method - DELETE: HTTP DELETE method
                        result:
                          type: string
                          description: >-
                            For HTTP protocol, it contains HTTP status code of
                            the invocation
                        invocationTime:
                          type: string
                          description: >-
                            string with format "date-time" as defined in
                            OpenAPI.
                        invocationLatency:
                          type: integer
                          description: >-
                            Unsigned integer identifying a period of time in
                            units of milliseconds.
                          minimum: 0
                        inputParameters:
                          description: >-
                            List of input parameters. Can be any value - string,
                            number, boolean, array or object.
                        outputParameters:
                          description: >-
                            List of output parameters. Can be any value -
                            string, number, boolean, array or object.
                        srcInterface:
                          type: object
                          properties:
                            ipv4Addr:
                              type: string
                              description: >-
                                string identifying a Ipv4 address formatted in
                                the "dotted decimal" notation as defined in IETF
                                RFC 1166.
                            ipv6Addr:
                              type: string
                              description: >-
                                string identifying a Ipv6 address formatted
                                according to clause 4 in IETF RFC 5952. The
                                mixed Ipv4 Ipv6 notation according to clause 5
                                of IETF RFC 5952 shall not be used.
                            port:
                              type: integer
                              description: >-
                                Unsigned integer with valid values between 0 and
                                65535.
                              minimum: 0
                              maximum: 65535
                            securityMethods:
                              type: array
                              items:
                                anyOf:
                                  - type: string
                                    enum:
                                      - PSK
                                      - PKI
                                      - OAUTH
                                  - type: string
                                    description: >
                                      This string provides forward-compatibility
                                      with future extensions to the enumeration
                                      but is not used to encode content defined
                                      in the present version of this API.
                                description: >
                                  Possible values are - PSK: Security method 1
                                  (Using TLS-PSK) as described in 3GPP TS 33.122
                                  - PKI: Security method 2 (Using PKI) as
                                  described in 3GPP TS 33.122 - OAUTH: Security
                                  method 3 (TLS with OAuth token) as described
                                  in 3GPP TS 33.122
                              minItems: 1
                              description: >-
                                Security methods supported by the interface, it
                                take precedence over the security methods
                                provided in AefProfile, for this specific
                                interface.
                          oneOf:
                            - required:
                                - ipv4Addr
                            - required:
                                - ipv6Addr
                        destInterface:
                          type: object
                          properties:
                            ipv4Addr:
                              type: string
                              description: >-
                                string identifying a Ipv4 address formatted in
                                the "dotted decimal" notation as defined in IETF
                                RFC 1166.
                            ipv6Addr:
                              type: string
                              description: >-
                                string identifying a Ipv6 address formatted
                                according to clause 4 in IETF RFC 5952. The
                                mixed Ipv4 Ipv6 notation according to clause 5
                                of IETF RFC 5952 shall not be used.
                            port:
                              type: integer
                              description: >-
                                Unsigned integer with valid values between 0 and
                                65535.
                              minimum: 0
                              maximum: 65535
                            securityMethods:
                              type: array
                              items:
                                anyOf:
                                  - type: string
                                    enum:
                                      - PSK
                                      - PKI
                                      - OAUTH
                                  - type: string
                                    description: >
                                      This string provides forward-compatibility
                                      with future extensions to the enumeration
                                      but is not used to encode content defined
                                      in the present version of this API.
                                description: >
                                  Possible values are - PSK: Security method 1
                                  (Using TLS-PSK) as described in 3GPP TS 33.122
                                  - PKI: Security method 2 (Using PKI) as
                                  described in 3GPP TS 33.122 - OAUTH: Security
                                  method 3 (TLS with OAuth token) as described
                                  in 3GPP TS 33.122
                              minItems: 1
                              description: >-
                                Security methods supported by the interface, it
                                take precedence over the security methods
                                provided in AefProfile, for this specific
                                interface.
                          oneOf:
                            - required:
                                - ipv4Addr
                            - required:
                                - ipv6Addr
                        fwdInterface:
                          type: string
                          description: >-
                            It includes the node identifier (as defined in IETF
                            RFC 7239 of all forwarding entities between the API
                            invoker and the AEF, concatenated with comma and
                            space, e.g. 192.0.2.43:80, unknown:_OBFport,
                            203.0.113.60
                      required:
                        - apiId
                        - apiName
                        - apiVersion
                        - resourceName
                        - protocol
                        - result
                    minItems: 1
                    description: Service API invocation log
                  supportedFeatures:
                    type: string
                    pattern: '^[A-Fa-f0-9]*$'
                required:
                  - aefId
                  - apiInvokerId
                  - logs
        '400':
          description: Bad request
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '401':
          description: Unauthorized
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '403':
          description: Forbidden
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '404':
          description: Not Found
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '406':
          description: Not Acceptable
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '414':
          description: URI Too Long
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '429':
          description: Too Many Requests
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '500':
          description: Internal Server Error
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        '503':
          description: Service Unavailable
          content:
            application/problem+json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  title:
                    type: string
                    description: >-
                      A short, human-readable summary of the problem type. It
                      should not change from occurrence to occurrence of the
                      problem.
                  status:
                    type: integer
                    description: The HTTP status code for this occurrence of the problem.
                  detail:
                    type: string
                    description: >-
                      A human-readable explanation specific to this occurrence
                      of the problem.
                  instance:
                    type: string
                    description: >-
                      string providing an URI formatted according to IETF RFC
                      3986.
                  cause:
                    type: string
                    description: >-
                      A machine-readable application error cause specific to
                      this occurrence of the problem. This IE should be present
                      and provide application-related error information, if
                      available.
                  invalidParams:
                    type: array
                    items:
                      type: object
                      properties:
                        param:
                          type: string
                          description: >-
                            Attribute's name encoded as a JSON Pointer, or
                            header's name.
                        reason:
                          type: string
                          description: >-
                            A human-readable reason, e.g. "must be a positive
                            integer".
                      required:
                        - param
                    minItems: 1
                    description: >-
                      Description of invalid parameters, for a request rejected
                      due to invalid parameters.
        default:
          description: Generic Error
